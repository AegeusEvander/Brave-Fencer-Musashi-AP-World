from typing import Dict, NamedTuple, Set, Optional, List, ClassVar

MAIN_RAM: str = "MainRAM"

bakery_locations: List[int] = [
    0x2015, #Chapter 2
    0x2056, #Chapter 3
    0x207b, #Chapter 4
    0x2098  #Chapter 5 and 6
]

restaurant_locations: List[int] = [
    0x201a, #Chapter 2
    0x2080, #Chapter 4
    0x209d  #Chapter 5 and 6
]

grocery_locations: List[int] = [
    0x2016, #Chapter 2
    0x2057, #Chapter 3
    0x207c, #Chapter 4
    0x2099  #Chapter 5 and 6
]

toy_shop_locations: List[int] = [
    0x2013, #Chapter 2
    0x2055, #Chapter 3
    0x207a, #Chapter 4
    0x2097  #Chapter 5 and 6
]

class StoreData(NamedTuple):
    inventory_id: int
    inventory_pointer_upper_pointer: int
    inventory_pointer_upper: List[int]
    inventory_pointer_lower_pointer: int
    inventory_pointer_lower: List[int]
    inventory_length_id: int
    inventory_length_id_expanded: Optional[int] = None

store_table: Dict[int, List[StoreData]] = {
    0x2015: [StoreData(0x1fab10, 0x189ab4, [0x20, 0x80], 0x189ab8, [0x10, 0xab], 0x189aa0, inventory_length_id_expanded = 0x189ab0), 
    StoreData(0x1fab10, 0x189cf0, [0x20, 0x80], 0x189cf4, [0x10, 0xab], 0x189cdc, inventory_length_id_expanded = 0x189cec)], #Bakery chapter 2
    0x2056: [StoreData(0x1fab10, 0x18671c, [0x20, 0x80], 0x186720, [0x10, 0xab], 0x186718, inventory_length_id_expanded = 0x186708), 
    StoreData(0x1fab10, 0x18691c, [0x20, 0x80], 0x186920, [0x10, 0xab], 0x186918, inventory_length_id_expanded = 0x186908)], #Bakery chapter 3
    0x207b: [StoreData(0x1fab10, 0x186ff4, [0x20, 0x80], 0x186ff8, [0x10, 0xab], 0x186fe0, inventory_length_id_expanded = 0x186ff0), 
    StoreData(0x1fab10, 0x1871f4, [0x20, 0x80], 0x1871f8, [0x10, 0xab], 0x1871e0, inventory_length_id_expanded = 0x1871f0)], #Bakery chapter 4
    0x2098: [StoreData(0x1fab10, 0x186cf4, [0x20, 0x80], 0x186cf8, [0x10, 0xab], 0x186cf0, inventory_length_id_expanded = 0x186ce0), 
    StoreData(0x1fab10, 0x186ef4, [0x20, 0x80], 0x186ef8, [0x10, 0xab], 0x186ee0, inventory_length_id_expanded = 0x186ef0)], #Bakery chapter 5, 6
    0x201a: [StoreData(0x1c16bc, 0x189ad8, [0x20, 0x80], 0x189adc, [0x10, 0xab], 0x1c160a),
    StoreData(0x1c1614, 0x189d14, [0x20, 0x80], 0x189d18, [0x10, 0xab], 0x1c1562)], #Restaurant chapter 2
    0x2080: [StoreData(0x1b92dc, 0x187018, [0x20, 0x80], 0x18701c, [0x10, 0xab], 0x1b922a),
    StoreData(0x1b94cc, 0x187218, [0x20, 0x80], 0x18721c, [0x10, 0xab], 0x1b941a)], #Restaurant chapter 4
    0x209d: [StoreData(0x1b9298, 0x186d18, [0x20, 0x80], 0x186d1c, [0x10, 0xab], 0x1b91e6),
    StoreData(0x1b9488, 0x186f18, [0x20, 0x80], 0x186f1c, [0x10, 0xab], 0x1b93d6)], #Restaurant chapter 5, 6
    #0x2016: StoreData(0x1c1660, 0x1c168c, [0x60, 0x16, 0x1c, 0x80]*8, 0x0, [], 0x1c16ac), #Grocery chapter 2
    #0x2057: StoreData(0x1bc9c8, 0x1bc9f4, [0xc8, 0xc9, 0x1b, 0x80]*8, 0x0, [], 0x1bca14), #Grocery chapter 3
    #0x207c: StoreData(0x1b9280, 0x1b92ac, [0x80, 0x92, 0x1b, 0x80]*8, 0x0, [], 0x1b92cc), #Grocery chapter 4
    #0x2099: StoreData(0x1b923c, 0x1b9268, [0x3c, 0x92, 0x1b, 0x80]*8, 0x0, [], 0x1b9288), #Grocery chapter 5, 6
    0x2016: [StoreData(0x1fab10, 0x1c168c, [0x10, 0xab, 0x1f, 0x80]*8, 0x0, [], 0x1c16ac), 
    StoreData(0x1fab10, 0x1c15e4, [0x10, 0xab, 0x1f, 0x80]*8, 0x0, [], 0x1c1604)], #Grocery chapter 2
    0x2057: [StoreData(0x1fab10, 0x1bc9f4, [0x10, 0xab, 0x1f, 0x80]*8, 0x0, [], 0x1bca14),
    StoreData(0x1fab10, 0x1bc6e0, [0x10, 0xab, 0x1f, 0x80]*8, 0x0, [], 0x1bc700)], #Grocery chapter 3
    0x207c: [StoreData(0x1fab10, 0x1b92ac, [0x10, 0xab, 0x1f, 0x80]*8, 0x0, [], 0x1b92cc),
    StoreData(0x1fab10, 0x1b949c, [0x10, 0xab, 0x1f, 0x80]*8, 0x0, [], 0x1b94bc)], #Grocery chapter 4
    0x2099: [StoreData(0x1fab10, 0x1b9268, [0x10, 0xab, 0x1f, 0x80]*8, 0x0, [], 0x1b9288),
    StoreData(0x1fab10, 0x1b9458, [0x10, 0xab, 0x1f, 0x80]*8, 0x0, [], 0x1b9478)], #Grocery chapter 5, 6
}

restaurant_pointers: Dict[int, List[Dict[int, List[int]]]] = {
    0x201a: [{0x40: [0xec, 0x17, 0x11, 0x80],
    0x71: [0x9c, 0x0b, 0x1f, 0x80], 
    0x72: [0xd4, 0x0b, 0x1f, 0x80], 
    0x73: [0x04, 0x0c, 0x1f, 0x80], 
    0x74: [0x1c, 0x0c, 0x1f, 0x80], 
    0x75: [0x3c, 0x0c, 0x1f, 0x80],
    0x76: [0x70, 0x0c, 0x1f, 0x80],
    0x77: [0xa0, 0x0c, 0x1f, 0x80],},
    {0x40: [0xa8, 0x2d, 0x11, 0x80],
    0x71: [0xc4, 0x06, 0x1f, 0x80], 
    0x72: [0xf0, 0x06, 0x1f, 0x80], 
    0x73: [0x14, 0x07, 0x1f, 0x80], 
    0x74: [0x34, 0x07, 0x1f, 0x80], 
    0x75: [0x5c, 0x07, 0x1f, 0x80],
    0x76: [0x84, 0x07, 0x1f, 0x80],
    0x77: [0xac, 0x07, 0x1f, 0x80],}], #Restaurant chapter 2
    0x2080: [{0x40: [0xec, 0x17, 0x11, 0x80],
    0x71: [0x90, 0x91, 0x1e, 0x80], 
    0x72: [0xc8, 0x91, 0x1e, 0x80], 
    0x73: [0xf8, 0x91, 0x1e, 0x80], 
    0x74: [0x10, 0x92, 0x1e, 0x80], 
    0x75: [0x30, 0x92, 0x1e, 0x80],
    0x76: [0x64, 0x92, 0x1e, 0x80],
    0x77: [0x94, 0x92, 0x1e, 0x80],},
    {0x40: [0xa8, 0x2d, 0x11, 0x80],
    0x71: [0xc8, 0x8b, 0x1e, 0x80], 
    0x72: [0xf4, 0x8b, 0x1e, 0x80], 
    0x73: [0x18, 0x8c, 0x1e, 0x80], 
    0x74: [0x38, 0x8c, 0x1e, 0x80], 
    0x75: [0x60, 0x8c, 0x1e, 0x80],
    0x76: [0x88, 0x8c, 0x1e, 0x80],
    0x77: [0xb0, 0x8c, 0x1e, 0x80],}],#Restaurant chapter 4
    0x209d: [{0x40: [0xec, 0x17, 0x11, 0x80],
    0x71: [0x18, 0xf0, 0x1e, 0x80], 
    0x72: [0x50, 0xf0, 0x1e, 0x80], 
    0x73: [0x80, 0xf0, 0x1e, 0x80], 
    0x74: [0x98, 0xf0, 0x1e, 0x80], 
    0x75: [0xb8, 0xf0, 0x1e, 0x80],
    0x76: [0xec, 0xf0, 0x1e, 0x80],
    0x77: [0x1c, 0xf1, 0x1e, 0x80],},
    {0x40: [0xa8, 0x2d, 0x11, 0x80],
    0x71: [0x58, 0xeb, 0x1e, 0x80], 
    0x72: [0x84, 0xeb, 0x1e, 0x80], 
    0x73: [0xa8, 0xeb, 0x1e, 0x80], 
    0x74: [0xc8, 0xeb, 0x1e, 0x80], 
    0x75: [0xf0, 0xeb, 0x1e, 0x80],
    0x76: [0x18, 0xec, 0x1e, 0x80],
    0x77: [0x40, 0xec, 0x1e, 0x80],}],#Restaurant chapter 5, 6
}

restaurant_pointers_pointers: Dict[int, List[int]] = {
    0x201a: [0x1c17b4, 0x1c170c], #Restaurant chapter 2
    0x2080: [0x1b93d4, 0x1b95c4], #Restaurant chapter 4
    0x209d: [0x1b9390, 0x1b9580], #Restaurant chapter 5, 6
}

toy_shop_fix: Dict[int, List[int]] = {
    0x2013: [0x18c19c, 0x18c3d8],
    0x2055: [0x188e04, 0x189004],
    0x207a: [0x1896dc, 0x1898dc],
    0x2097: [0x1893dc, 0x1895dc]
}

toy_shop_dialog: Dict[int, List[List[int]]] = {
    0x2013: [[ #Chapter 2 toy shop
        0x1f0760,
        0x1f07b8,
        0x1f07ec,
        0x1f0830,
        0x1f0878,
        0x1f089c,
        0x1f08dc,
        0x1f0920,
        0x1f0960,
        0x1f099c,
        0x1f09dc,
        0x1f0a24,
        0x1f0a6c,
        0x1f0a9c,
        0x1f0ae8,
        0x1f0b1c,
        0x1f0b54,
        0x1f0ba0,
        0x1f0bcc,
        0x1f0c04,
        0x1f0c34,
        0x1f0c70,
        0x1f0cb4,
        0x1f0d04,
        0x1f0d44,
        0x1f0d68,
        0x1f0dac,
        0x1f0dec,
        0x1f0e24,
        0x1f0e5c,
        0x1f0ea4,
        0x1f0eec,
        0x1f0f2c,
        0x1f0f6c,
        0x1f0fac,
        0x1f0fd8,
        0x1f1018,
        0x1f104c,
        0x1f108c,
        0x1f10bc,
        0x1f1108,
        0x1f1144,
        0x1f117c
    ], 
    [
        0x1f0398,
        0x1f03c4,
        0x1f03f8,
        0x1f041c,
        0x1f0440,
        0x1f0468,
        0x1f0494,
        0x1f04b8,
        0x1f04e4,
        0x1f0514,
        0x1f053c,
        0x1f0564,
        0x1f0590,
        0x1f05b4,
        0x1f05dc,
        0x1f0610,
        0x1f063c,
        0x1f0668,
        0x1f068c,
        0x1f06bc,
        0x1f06e8,
        0x1f0718,
        0x1f074c,
        0x1f0778,
        0x1f07a8,
        0x1f07cc,
        0x1f07f4,
        0x1f0828,
        0x1f0858,
        0x1f0884,
        0x1f08ac,
        0x1f08dc,
        0x1f0908,
        0x1f0938,
        0x1f0964,
        0x1f0994,
        0x1f09c8,
        0x1f09fc,
        0x1f0a30,
        0x1f0a5c,
        0x1f0a84,
        0x1f0aa8,
        0x1f0ae0
    ]],
    0x2055: [[ #Chapter 3 toy shop
        0x1e37e4,
        0x1e383c,
        0x1e3870,
        0x1e38b4,
        0x1e38fc,
        0x1e3920,
        0x1e3960,
        0x1e39a4,
        0x1e39e4,
        0x1e3a20,
        0x1e3a60,
        0x1e3aa8,
        0x1e3af0,
        0x1e3b20,
        0x1e3b6c,
        0x1e3ba0,
        0x1e3bd8,
        0x1e3c24,
        0x1e3c50,
        0x1e3c88,
        0x1e3cb8,
        0x1e3cf4,
        0x1e3d38,
        0x1e3d88,
        0x1e3dc8,
        0x1e3dec,
        0x1e3e30,
        0x1e3e70,
        0x1e3ea8,
        0x1e3ee0,
        0x1e3f28,
        0x1e3f70,
        0x1e3fb0,
        0x1e3ff0,
        0x1e4030,
        0x1e405c,
        0x1e409c,
        0x1e40d0,
        0x1e4110,
        0x1e4140,
        0x1e418c,
        0x1e41c8,
        0x1e4200
    ], [
        0x1e31b4,
        0x1e31e0,
        0x1e3214,
        0x1e3238,
        0x1e325c,
        0x1e3284,
        0x1e32b0,
        0x1e32d4,
        0x1e3300,
        0x1e3330,
        0x1e3358,
        0x1e3380,
        0x1e33ac,
        0x1e33d0,
        0x1e33f8,
        0x1e342c,
        0x1e3458,
        0x1e3484,
        0x1e34a8,
        0x1e34d8,
        0x1e3504,
        0x1e3534,
        0x1e3568,
        0x1e3594,
        0x1e35c4,
        0x1e35e8,
        0x1e3610,
        0x1e3644,
        0x1e3674,
        0x1e36a0,
        0x1e36c8,
        0x1e36f8,
        0x1e3724,
        0x1e3754,
        0x1e3780,
        0x1e37b0,
        0x1e37e4,
        0x1e3818,
        0x1e384c,
        0x1e3878,
        0x1e38a0,
        0x1e38c4,
        0x1e38fc
    ]],
    0x207a: [[ #Chapter 4 toy shop
        0x1e8d4c,
        0x1e8da4,
        0x1e8dd8,
        0x1e8e1c,
        0x1e8e64,
        0x1e8e88,
        0x1e8ec8,
        0x1e8f0c,
        0x1e8f4c,
        0x1e8f88,
        0x1e8fc8,
        0x1e9010,
        0x1e9058,
        0x1e9088,
        0x1e90d4,
        0x1e9108,
        0x1e9140,
        0x1e918c,
        0x1e91b8,
        0x1e91f0,
        0x1e9220,
        0x1e925c,
        0x1e92a0,
        0x1e92f0,
        0x1e9330,
        0x1e9354,
        0x1e9398,
        0x1e93d8,
        0x1e9410,
        0x1e9448,
        0x1e9490,
        0x1e94d8,
        0x1e9518,
        0x1e9558,
        0x1e9598,
        0x1e95c4,
        0x1e9604,
        0x1e9638,
        0x1e9678,
        0x1e96a8,
        0x1e96f4,
        0x1e9730,
        0x1e9768
    ], [
        0x1e8894,
        0x1e88c0,
        0x1e88f4,
        0x1e8918,
        0x1e893c,
        0x1e8964,
        0x1e8990,
        0x1e89b4,
        0x1e89e0,
        0x1e8a10,
        0x1e8a38,
        0x1e8a60,
        0x1e8a8c,
        0x1e8ab0,
        0x1e8ad8,
        0x1e8b0c,
        0x1e8b38,
        0x1e8b64,
        0x1e8b88,
        0x1e8bb8,
        0x1e8be4,
        0x1e8c14,
        0x1e8c48,
        0x1e8c74,
        0x1e8ca4,
        0x1e8cc8,
        0x1e8cf0,
        0x1e8d24,
        0x1e8d54,
        0x1e8d80,
        0x1e8da8,
        0x1e8dd8,
        0x1e8e04,
        0x1e8e34,
        0x1e8e60,
        0x1e8e90,
        0x1e8ec4,
        0x1e8ef8,
        0x1e8f2c,
        0x1e8f58,
        0x1e8f80,
        0x1e8fa4,
        0x1e8fdc
    ]],
    0x2097: [[ #Chapter 5 toy shop
        0x1eebdc,
        0x1eec34,
        0x1eec68,
        0x1eecac,
        0x1eecf4,
        0x1eed18,
        0x1eed58,
        0x1eed9c,
        0x1eeddc,
        0x1eee18,
        0x1eee58,
        0x1eeea0,
        0x1eeee8,
        0x1eef18,
        0x1eef64,
        0x1eef98,
        0x1eefd0,
        0x1ef01c,
        0x1ef048,
        0x1ef080,
        0x1ef0b0,
        0x1ef0ec,
        0x1ef130,
        0x1ef180,
        0x1ef1c0,
        0x1ef1e4,
        0x1ef228,
        0x1ef268,
        0x1ef2a0,
        0x1ef2d8,
        0x1ef320,
        0x1ef368,
        0x1ef3a8,
        0x1ef3e8,
        0x1ef428,
        0x1ef454,
        0x1ef494,
        0x1ef4c8,
        0x1ef508,
        0x1ef538,
        0x1ef584,
        0x1ef5c0,
        0x1ef5f8
    ], [
        0x1ee82c,
        0x1ee858,
        0x1ee88c,
        0x1ee8b0,
        0x1ee8d4,
        0x1ee8fc,
        0x1ee928,
        0x1ee94c,
        0x1ee978,
        0x1ee9a8,
        0x1ee9d0,
        0x1ee9f8,
        0x1eea24,
        0x1eea48,
        0x1eea70,
        0x1eeaa4,
        0x1eead0,
        0x1eeafc,
        0x1eeb20,
        0x1eeb50,
        0x1eeb7c,
        0x1eebac,
        0x1eebe0,
        0x1eec0c,
        0x1eec3c,
        0x1eec60,
        0x1eec88,
        0x1eecbc,
        0x1eecec,
        0x1eed18,
        0x1eed40,
        0x1eed70,
        0x1eed9c,
        0x1eedcc,
        0x1eedf8,
        0x1eee28,
        0x1eee5c,
        0x1eee90,
        0x1eeec4,
        0x1eeef0,
        0x1eef18,
        0x1eef3c,
        0x1eef74
    ]]
}

toy_shop_dialog_length: List[List[int]] = [[
    88,
    52,
    68,
    72,
    36,
    64,
    68,
    64,
    60,
    64,
    72,
    72,
    48,
    76,
    52,
    56,
    76,
    44,
    56,
    48,
    60,
    68,
    80,
    64,
    36,
    68,
    64,
    56,
    56,
    72,
    72,
    64,
    64,
    64,
    44,
    64,
    52,
    64,
    48,
    76,
    60,
    56,
    56
], [
    44,
    52,
    36,
    36,
    40,
    44,
    36,
    44,
    48,
    40,
    40,
    44,
    36,
    40,
    52,
    44,
    44,
    36,
    48,
    44,
    48,
    52,
    44,
    48,
    36,
    40,
    52,
    48,
    44,
    40,
    48,
    44,
    48,
    44,
    48,
    52,
    52,
    52,
    44,
    40,
    36,
    56,
    40
]]

tech_fix=[[
    (0x1818d0, [0x84], MAIN_RAM),
    (0x18073c, [0x84], MAIN_RAM),
    (0x180674, [0x84], MAIN_RAM),
    (0x180998, [0x84], MAIN_RAM),
    (0x181080, [0x84], MAIN_RAM),
    (0x1810ec, [0x84], MAIN_RAM),
    (0x181314, [0x84], MAIN_RAM)
], [
    (0x181ad0, [0x84], MAIN_RAM),
    (0x18093c, [0x84], MAIN_RAM),
    (0x180874, [0x84], MAIN_RAM),
    (0x180b98, [0x84], MAIN_RAM),
    (0x181280, [0x84], MAIN_RAM),
    (0x1812ec, [0x84], MAIN_RAM),
    (0x181514, [0x84], MAIN_RAM)
]]

tech_check_locations=[[
    (0x0ba20c, 1, MAIN_RAM), #Artisan
    (0x0ba1fb, 1, MAIN_RAM), #Maid
    (0x0ba1f5, 1, MAIN_RAM), #Clown
    (0x0ba200, 1, MAIN_RAM), #KnightB
    (0x0ba207, 1, MAIN_RAM), #KnightA
    (0x0ba216, 1, MAIN_RAM), #KnightC
    (0x0ba218, 1, MAIN_RAM)  #KnightD
],[
    (0x0b936c, 1, MAIN_RAM), #Artisan JP
    (0x0b935b, 1, MAIN_RAM), #Maid
    (0x0b9355, 1, MAIN_RAM), #Clown
    (0x0b9360, 1, MAIN_RAM), #KnightB
    (0x0b9367, 1, MAIN_RAM), #KnightA
    (0x0b9376, 1, MAIN_RAM), #KnightC
    (0x0b9378, 1, MAIN_RAM)  #KnightD
]]

appraisal_items_buy_cost = [
    0x10eed0,
    0x10eee8,
    0x10ef00,
    0x10ef18,
    0x10ef30,
    0x10ef48,
    0x10ef60,
    0x10ef78,
    0x10ef90,
    0x10efa8,
    0x10efc0,
    0x10efd8,
    0x10eff0,
    0x10f008,
    0x10f020,
    0x10f038,
    0x10f050,
    0x10f068,
    0x10f080,
    0x10f098,
    0x10f0b0,
    0x10f0c8,
    0x10f0e0,
    0x10f0f8,
    0x10f110,
    0x10f128
]

appraisal_l_armor_buy_cost = [
    0x10f140,
    0x10f14c,
    0x10f158,
    0x10f164,
    0x10f170
]

key_item_buy_cost = [
    0x10f26c,
    0x10f278,
    0x10f284
]

store_sanity_buy_cost = [
    0x10f0d4,
    0x10f0ec,
    0x10f104
]